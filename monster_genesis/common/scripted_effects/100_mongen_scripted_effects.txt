##########################################################################
# Scripted Effects for Monster Genesis
#
# Written by TzverG
##########################################################################

#################################################
#	Variables									#
#################################################

@tiyanki_calf_age = 18250				# 50 years
@tiyanki_calf_age_random = 7300	 		# 20 years

@tiyanki_cow_age = 36500				# 100 years
@tiyanki_cow_age_random = 10950			# 30 years

@tiyanki_matriarch_age = 18250			# 50 years
@tiyanki_matriarch_age_random = 7300	# 20 years

#@tiyanki_calf_age = 300
#@tiyanki_calf_age_random = 0

#@tiyanki_cow_age = 300
#@tiyanki_cow_age_random = 0

#@tiyanki_matriarch_age = 200
#@tiyanki_matriarch_age_random = 0

@orbiting_delay_calf = 30
@orbiting_delay_calf_random = 150

@orbiting_delay_cow = 30
@orbiting_delay_cow_random = 60

@orbiting_delay_bull = 15
@orbiting_delay_bull_random = 10

@orbiting_delay_matriarch = 30
@orbiting_delay_matriarch_random = 30

@faction_random_years_of_joy_a = 1
@faction_random_years_of_joy_b = 5
@faction_random_years_of_joy_c = 10

@job_popularity_years = 2

@sky_visiter_duration_days = 90
@tiyanki_effect_duration_years = 10

# Creates the monster countries
create_monster_genesis_country = {
	if = {
		limit = { 
			NOT = { 
				exists = event_target:monster_genesis_tiyanki_country
			}
		}
		
		create_country = {
			name = "tiyanki_country"
			type = monster_genesis_tiyanki
			auto_delete = no
			flag = {
				icon = {
					category = "zoological"
					file = "flag_zoological_11.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors={
					"black"
					"black"
					"null"
					"null"
				}
			}
		}
		
		last_created_country = {
			save_global_event_target_as = monster_genesis_tiyanki_country
			
			set_name = monster_genesis.0.name
			
			# Make yourselves known to everybody
			every_country = {
				limit = { 
					NOT = { 
						has_communications = event_target:monster_genesis_tiyanki_country
					}
				}
				
				establish_communications_no_message = event_target:monster_genesis_tiyanki_country
				event_target:monster_genesis_tiyanki_country = {
					establish_communications_no_message = PREV
				}
			}
			
			# Tiyankis are friendly to creators
			set_faction_hostility = {
				target = event_target:monster_genesis_creator
				set_hostile = no
				set_neutral = no
				set_friendly = yes
			}
			
			# Disable attacking enclave stations
			every_country = {
				limit = { 
					is_country_type = enclave 
				}
					
				set_faction_hostility = {
					target = PREV
					set_hostile = no
					set_neutral = no
					set_friendly = yes
				}
			}
			
			# Tiyankis are friendly to some other monsters
			every_country = {
				limit = {
					is_country_type = cloud
				}
					
				set_faction_hostility = {
					target = PREV
					set_hostile = no
					set_neutral = no
					set_friendly = yes
				}
			}
		}
	}
}

# Reconcile the empires ot Giyanki and Crystall
reconcile_mongen_empire_with_crystall = {
	every_country = {
		limit = {
			exists = event_target:monster_genesis_tiyanki_country
			is_crystal_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = no
			set_neutral = no
			set_friendly = yes
		}
	}
}

# Neutralize relations ot Giyanki and Crystall empires
neutralize_mongen_empire_with_crystall = {
	every_country = {
		limit = { 
			exists = event_target:monster_genesis_tiyanki_country
			is_crystal_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = no
			set_neutral = yes
			set_friendly = no
		}
	}
}

# Quarrel the empires ot Giyanki and Crystall
quarrel_mongen_empire_with_crystall = {
	every_country = {
		limit = { 
			exists = event_target:monster_genesis_tiyanki_country
			is_crystal_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = yes
			set_neutral = no
			set_friendly = no
		}
	}
}

# Reconcile the empires ot Giyanki and Amoeba
reconcile_mongen_empire_with_amoeba = {
	every_country = {
		limit = {
			exists = event_target:monster_genesis_tiyanki_country
			is_amoeba_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = no
			set_neutral = no
			set_friendly = yes
		}
	}
}

# Neutralize relations ot Giyanki and Amoeba empires
neutralize_mongen_empire_with_amoeba = {
	every_country = {
		limit = { 
			exists = event_target:monster_genesis_tiyanki_country
			is_amoeba_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = no
			set_neutral = yes
			set_friendly = no
		}
	}
}

# Quarrel the empires ot Giyanki and Amoeba
quarrel_mongen_empire_with_amoeba = {
	every_country = {
		limit = { 
			exists = event_target:monster_genesis_tiyanki_country
			is_amoeba_country_type = yes
		}
			
		set_faction_hostility = {
			target = event_target:monster_genesis_tiyanki_country
			set_hostile = yes
			set_neutral = no
			set_friendly = no
		}
	}
}

# Create a Tiyanki fleet for evolution from CALF
create_monster_genesis_tiyanki_random_fleet = {
	random_list = {
		50 ={
			create_monster_genesis_tiyanki_cow = yes
		}
		50 ={
			create_monster_genesis_tiyanki_bull = yes
		}
	}
	#update_sky_visiter_modifiers = yes
}

# Trying create tiyanky calf and run event with description when failed
trying_create_tiyanki_calf = {
	random_list = {
		30 ={
			country_event = { id = monster_genesis.33 }
		}
		70 ={
			create_monster_genesis_tiyanki_calf = yes
		}
	}
}

# Create a Tiyanki Calf Fleet
create_monster_genesis_tiyanki_calf = {
	if = {
		limit = {
			AND = {
				exists = event_target:monster_genesis_tiyanki_country
				exists = event_target:monster_genesis_creator
			}
		}
		
		event_target:monster_genesis_tiyanki_country = {
			create_fleet = {
				name = "NAME_Calf"
				settings = {
					can_upgrade = no
					can_change_composition = no
					can_change_leader = no
					uses_naval_capacity = no
				}
				effect = {
					set_owner = event_target:monster_genesis_tiyanki_country
					create_monster_genesis_tiyanki_calf_ship = yes
					
					#event_target:monster_genesis_creator.capital_scope = {
					#	save_event_target_as = spawn_location
					#}
					
					event_target:monster_genesis_creator = {
						country_event = { id = monster_genesis.6 }
						
						random_list = {
							34 = { 
								set_timed_country_flag = {
									flag = mongen_calf_created
									years = @faction_random_years_of_joy_a
								}
							}
							34 = { 
								set_timed_country_flag = {
									flag = mongen_calf_created
									years = @faction_random_years_of_joy_b
								}
							}
							34 = { 
								set_timed_country_flag = {
									flag = mongen_calf_created
									years = @faction_random_years_of_joy_c
								}
							}
						}
					}
					
					set_fleet_flag = tiyanky_calf
					set_timed_fleet_flag = { 
						flag = tiyanky_calf_age
						days = @tiyanki_calf_age
					}
					
					event_target:monster_genesis_creator = {
						country_event = { 
							id = monster_genesis.10
							days = @tiyanki_calf_age
							random = @tiyanki_calf_age_random
						}
					}
					
					set_location = {
						target = event_target:new_spawn_location
						distance = 5
						angle = random
					}
					
					set_aggro_range_measure_from = self
					set_aggro_range = 150
					
					set_formation_scale = 3
					
					# Fleet Orders (duplicate code required for fix problem with reading trigger.h)
					# create_monster_genesis_tiyanki_calf_actions = yes
					
					if = {
						limit = {
							exists = event_target:monster_genesis_creator
							event_target:monster_genesis_creator = {
								has_policy_flag = mongen_policy_free
							}
						}
						
						set_fleet_stance = passive
						
						queue_actions = {
							repeat = {
								find_random_system = {
									trigger = {
										id = mongen_calf_actions.trigger.1
										is_inside_border = event_target:monster_genesis_creator
									}
									found_system = {
										
										move_to = this
						
										wait = {
											duration = @orbiting_delay_calf
											random = @orbiting_delay_calf_random
										}
						
										find_random_planet = {
											trigger = {
												id = mongen_calf_actions.trigger.2
												is_planet_class = pc_gas_giant
												has_modifier = grazing_candidate
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												wait = {
													duration = @orbiting_delay_calf
													random = @orbiting_delay_calf_random
												}
												
												effect = {
													id = mongen_calf_actions.effect.1
													update_gas_giant_deposit = yes
												}
											}
										}
										find_closest_planet = {
											trigger = {
												id = mongen_calf_actions.trigger.3
												is_colony = yes
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												effect = {
													id = mongen_calf_actions.effect.2
													if = {
														limit = {
															has_modifier = sky_visiter
														}
														remove_modifier = sky_visiter
													}
													add_modifier = { 
														modifier = sky_visiter 
														#days = -1
														days = @sky_visiter_duration_days
													}
												}
												
												wait = {
													duration = @orbiting_delay_calf
													random = @orbiting_delay_calf_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_calf_actions.trigger.4
												is_star = no
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												wait = {
													duration = @orbiting_delay_calf
													random = @orbiting_delay_calf_random
												}
											}
										}
									}
								}
							}
						}
					} else_if = {
						limit = {
							exists = event_target:monster_genesis_creator
							event_target:monster_genesis_creator = {
								has_policy_flag = mongen_policy_call
							}
						}
						
						set_fleet_stance = aggressive
						
						queue_actions = {
							find_closest_system = {
								trigger = {
									id = mongen_calf_actions.trigger.5
									is_inside_border = event_target:monster_genesis_creator
									any_system_planet = {
										has_modifier = the_last_frontier
									}
								}
								found_system = {
									move_to = this
									
									wait = {
										duration = @orbiting_delay_matriarch
										random = @orbiting_delay_matriarch_random
									}
									
									find_random_planet = {
										trigger = {
											id = mongen_calf_actions.trigger.6
											has_modifier = the_last_frontier
										}
										found_planet = {
											move_to = this
											orbit_planet = this
											
											wait = {
												duration = @orbiting_delay_matriarch
												random = @orbiting_delay_matriarch_random
											}
										}
									}
									find_random_planet = {
										trigger = {
											id = mongen_calf_actions.trigger.7
											is_planet_class = pc_gas_giant
										}
										found_planet = {
											move_to = this
											orbit_planet = this
									
											wait = {
												duration = @orbiting_delay_matriarch
												random = @orbiting_delay_matriarch_random
											}
										}
									}
									find_random_planet = {
										trigger = {
											id = mongen_calf_actions.trigger.8
											is_star = no
										}
										found_planet = {
											move_to = this
											orbit_planet = this
									
											wait = {
												duration = @orbiting_delay_matriarch
												random = @orbiting_delay_matriarch_random
											}
										}
									}
								}
							}
						}
					}
				}
			}
			last_created_fleet = {
				if = {
					limit = {
						exists = event_target:monster_genesis_creator
						event_target:monster_genesis_creator = {
							has_policy_flag = mongen_policy_follow
						}
					}
					event_target:monster_genesis_creator = {
						random_owned_fleet = {
							limit = {
								any_owned_ship = {
									is_ship_class = shipclass_science_ship
								}
							}
							save_event_target_as = fleet_for_follow
						}
					}
					
					if = {
						limit = {
							exists = event_target:fleet_for_follow
						}
						
						set_fleet_stance = passive
						
						auto_follow_fleet = {
							target = event_target:fleet_for_follow
							attack_fleet = no
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Cow Fleet
create_monster_genesis_tiyanki_cow = {
	if = {
		limit = {
			AND = {
				exists = event_target:monster_genesis_tiyanki_country
				exists = event_target:monster_genesis_creator
			}
		}
		
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					AND = {
						has_fleet_flag = tiyanky_calf
						NOT = {
							has_fleet_flag = tiyanky_calf_age
						}
					}
				}
				
				save_event_target_as = fleet_location
				
				delete_fleet = {
					target = this
					destroy_template = yes
				}
				
				create_fleet = {
					name = "NAME_Cow"
					settings = {
						can_upgrade = no
						can_disband = no
						can_change_composition = no
						can_change_leader = no
						uses_naval_capacity = no
					}
					effect = {
						set_owner = event_target:monster_genesis_tiyanki_country
						
						create_monster_genesis_tiyanki_cow_ship = yes
						
						event_target:monster_genesis_creator = {
							country_event = { id = monster_genesis.8 }
							set_timed_country_flag = {
								flag = mongen_cow_created
								years = @job_popularity_years
							}
						}
						
						set_fleet_flag = tiyanky_cow
						set_timed_fleet_flag = { 
							flag = tiyanky_cow_age
							days = @tiyanki_cow_age
						}
						
						event_target:monster_genesis_creator = {
							country_event = {
								id = monster_genesis.11
								days = @tiyanki_cow_age
								random = @tiyanki_cow_age_random
							}
						}
						
						set_location = {
							target = event_target:fleet_location
						}
						
						event_target:monster_genesis_creator = {
							country_event = {
								id = monster_genesis.31
							}
						}
						
						set_aggro_range_measure_from = self
						set_aggro_range = 170
						
						set_formation_scale = 3
						
						# Fleet Orders (duplicate code required for fix problem with reading trigger.h)
						#create_monster_genesis_tiyanki_cow_actions = yes
						
						if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_free
								}
							}
							
							set_fleet_stance = passive
							
							queue_actions = {
								repeat = {
									find_random_system = {
										trigger = {
											id = mongen_cow_actions.trigger.1
											is_inside_border = event_target:monster_genesis_creator
										}
										found_system = {
										
											move_to = this
						
											wait = {
												duration = @orbiting_delay_cow
												random = @orbiting_delay_cow_random
											}
						
											find_random_planet = {
												trigger = {
													id = mongen_cow_actions.trigger.2
													is_planet_class = pc_gas_giant
													has_modifier = grazing_candidate
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_cow
														random = @orbiting_delay_cow_random
													}
													
													effect = {
														id = mongen_cow_actions.effect.1
														update_gas_giant_deposit = yes
													}
												}
											}
											find_closest_planet = {
												trigger = {
													id = mongen_cow_actions.trigger.3
													is_star = no
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_cow
														random = @orbiting_delay_cow_random
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_cow_actions.trigger.4
													is_planet_class = pc_gas_giant
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_cow
														random = @orbiting_delay_cow_random
													}
												}
											}
										}
									}
								}
							}							
						} else_if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_call
								}
							}
							
							set_fleet_stance = aggressive
							
							queue_actions = {
								find_closest_system = {
									trigger = {
										id = mongen_cow_actions.trigger.5
										is_inside_border = event_target:monster_genesis_creator
										any_system_planet = {
											has_modifier = the_last_frontier
										}
									}
									found_system = {
										move_to = this
										
										wait = {
											duration = @orbiting_delay_matriarch
											random = @orbiting_delay_matriarch_random
										}
										
										find_random_planet = {
											trigger = {
												id = mongen_cow_actions.trigger.6
												has_modifier = the_last_frontier
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_cow_actions.trigger.7
												is_planet_class = pc_gas_giant
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_cow_actions.trigger.8
												is_star = no
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
									}
								}
							}
						}
					}
				}
				last_created_fleet = {
					if = {
						limit = {
							exists = event_target:monster_genesis_creator
							event_target:monster_genesis_creator = {
								has_policy_flag = mongen_policy_follow
							}
						}
						event_target:monster_genesis_creator = {
							random_owned_fleet = {
								limit = {
									any_owned_ship = {
										is_ship_class = shipclass_science_ship
									}
								}
								save_event_target_as = fleet_for_follow
							}
						}
						
						if = {
							limit = {
								exists = event_target:fleet_for_follow
							}
							
							set_fleet_stance = passive
							
							auto_follow_fleet = {
								target = event_target:fleet_for_follow
								attack_fleet = no
							}
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Bull Fleet
create_monster_genesis_tiyanki_bull = {
	if = {
		limit = {
			AND = {
				exists = event_target:monster_genesis_tiyanki_country
				exists = event_target:monster_genesis_creator
			}
		}
		
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					AND = {
						has_fleet_flag = tiyanky_calf
						NOT = {
							has_fleet_flag = tiyanky_calf_age
						}
					}
				}
				
				save_event_target_as = fleet_location
				
				delete_fleet = {
					target = this
					destroy_template = yes
				}
				
				create_fleet = {
					name = "NAME_Bull"
					settings = {
						can_upgrade = no
						can_disband = no
						can_change_composition = no
						can_change_leader = no
						uses_naval_capacity = no
					}
					effect = {
						set_owner = event_target:monster_genesis_tiyanki_country
						
						create_monster_genesis_tiyanki_bull_ship = yes
						
						event_target:monster_genesis_creator = {
							country_event = { id = monster_genesis.7 }
							set_timed_country_flag = {
								flag = mongen_bull_created
								years = @job_popularity_years
							}
						}
						
						set_fleet_flag = tiyanky_bull
						
						set_location = {
							target = event_target:fleet_location
						}
						
						event_target:monster_genesis_creator = {
							country_event = {
								id = monster_genesis.32
							}
						}
						
						set_aggro_range_measure_from = self
						set_aggro_range = 250
						
						# Fleet Orders (commented code generate error with unique trigger and effect id's)
						#create_monster_genesis_tiyanki_bull_actions = yes
						
						if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_free
								}
							}
							
							set_fleet_stance = aggressive
							
							queue_actions = {
								repeat = {
									find_random_system = {
										trigger = {
											id = mongen_bull_actions.trigger.1
											is_inside_border = event_target:monster_genesis_creator
										}
										found_system = {
											move_to = this
											
											wait = {
												duration = @orbiting_delay_bull
												random = @orbiting_delay_bull_random
											}
											
											find_random_planet = {
												trigger = {
													id = mongen_bull_actions.trigger.2
													is_planet_class = pc_gas_giant
													has_modifier = grazing_candidate
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_bull
														random = @orbiting_delay_bull_random
													}
													
													effect = {
														id = mongen_bull_actions.effect.1
														update_gas_giant_deposit = yes
													}
												}
											}
											find_closest_planet = {
												trigger = {
													id = mongen_bull_actions.trigger.3
													is_planet_class = pc_gas_giant
													NOT = { has_modifier = grazing_candidate }
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_bull
														random = @orbiting_delay_bull_random
													}
													
													effect = {
														id = mongen_bull_actions.effect.2
														if = {
															limit = {
																has_modifier = grazing_candidate
															}
															remove_modifier = grazing_candidate
														}
														add_modifier = {
															modifier = grazing_candidate
															days = -1
														}
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_bull_actions.trigger.4
													is_star = no
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_bull
														random = @orbiting_delay_bull_random
													}
												}
											}
										}
									}
								}
							}
						} else_if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_call
								}
							}
							
							set_fleet_stance = aggressive
							
							queue_actions = {
								find_closest_system = {
									trigger = {
										id = mongen_bull_actions.trigger.5
										is_inside_border = event_target:monster_genesis_creator
										any_system_planet = {
											has_modifier = the_last_frontier
										}
									}
									found_system = {
										move_to = this
										
										wait = {
											duration = @orbiting_delay_matriarch
											random = @orbiting_delay_matriarch_random
										}
										
										find_random_planet = {
											trigger = {
												id = mongen_bull_actions.trigger.6
												has_modifier = the_last_frontier
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_bull_actions.trigger.7
												is_planet_class = pc_gas_giant
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_bull_actions.trigger.8
												is_star = no
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
									}
								}
							}
						}
					}
				}
				last_created_fleet = {
					if = {
						limit = {
							exists = event_target:monster_genesis_creator
							event_target:monster_genesis_creator = {
								has_policy_flag = mongen_policy_follow
							}
						}
						event_target:monster_genesis_creator = {
							random_owned_fleet = {
								limit = {
									any_owned_ship = {
										is_ship_class = shipclass_science_ship
									}
								}
								save_event_target_as = fleet_for_follow
							}
						}
						
						if = {
							limit = {
								exists = event_target:fleet_for_follow
							}
							
							set_fleet_stance = passive
							
							auto_follow_fleet = {
								target = event_target:fleet_for_follow
								attack_fleet = no
							}
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Matriarch Fleet
create_monster_genesis_tiyanki_matriarch = {
	if = {
		limit = {
			AND = {
				exists = event_target:monster_genesis_tiyanki_country
				exists = event_target:monster_genesis_creator
				NOT = {
					is_any_monster_boss_active = yes
				}
			}
		}
		
		event_target:monster_genesis_creator = {
			country_event = { id = monster_genesis.9 }
		}
		
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					AND = {
						has_fleet_flag = tiyanky_cow
						NOT = {
							has_fleet_flag = tiyanky_cow_age
						}
						NOT = {
							has_fleet_flag = stop_tiyanky_cow_evolution
						}
					}
				}
				
				save_event_target_as = fleet_location
				
				delete_fleet = {
					target = this
					destroy_template = yes
				}
				
				create_fleet = {
					name = "NAME_MG_Progenitor"
					settings = {
						can_upgrade = no
						can_disband = no
						can_change_composition = no
						can_change_leader = no
						uses_naval_capacity = no
					}
					effect = {
						set_owner = event_target:monster_genesis_tiyanki_country
						
						create_monster_genesis_tiyanki_matriarch_ship = yes
						
						set_fleet_flag = tiyanky_matriarch
						set_timed_fleet_flag = { 
							flag = tiyanky_matriarch_age
							days = @tiyanki_matriarch_age
						}
						
						set_location = {
							target = event_target:fleet_location
						}
						
						event_target:monster_genesis_creator = {
							country_event = {
								id = monster_genesis.12
							}
							country_event = {
								id = monster_genesis.21
								days = @tiyanki_matriarch_age
								random = @tiyanki_matriarch_age_random
							}
							set_timed_country_flag = {
								flag = mongen_matriarch_created
								years = @job_popularity_years
							}
						}
						
						set_aggro_range_measure_from = self
						set_aggro_range = 200
						
						set_formation_scale = 3.0
						
						# Fleet Orders (commented code generate error with unique trigger and effect id's)
						#create_monster_genesis_tiyanki_matriarch_actions = yes
						
						if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_free
								}
							}
							
							set_fleet_stance = aggressive
							
							queue_actions = {
								repeat = {
									find_random_system = {
										trigger = {
											id = mongen_matriarch_actions.trigger.1
											is_inside_border = event_target:monster_genesis_creator
											
											any_system_planet = {
												is_colony = yes
											}
										}
										found_system = {
											move_to = this
											
											wait = {
												duration = @orbiting_delay_matriarch
												random = @orbiting_delay_matriarch_random
											}
											
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.2
													is_colony = yes
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													effect = {
														id = mongen_matriarch_actions.effect.1
														if = {
															limit = {
																has_modifier = sky_visiter
															}
															remove_modifier = sky_visiter
														}
														add_modifier = { 
															modifier = sky_visiter 
															#days = -1
															days = @sky_visiter_duration_days
														}
													}
											
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.3
													has_anomaly = yes
												}
												found_planet = {
													move_to = this
													orbit_planet = this
											
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.4
													is_planet_class = pc_gas_giant
													has_modifier = grazing_candidate
												}
												found_planet = {
													move_to = this
													orbit_planet = this
											
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
													
													effect = {
														id = mongen_matriarch_actions.effect.2
														update_gas_giant_deposit = yes
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.5
													is_planet_class = pc_gas_giant
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
													
													effect = {
														id = mongen_matriarch_actions.effect.3
														enhancement_gas_giant_deposit = yes
													}
												}
											}
										}
									}
									find_random_system = {
										trigger = {
											id = mongen_matriarch_actions.trigger.6
											is_inside_border = event_target:monster_genesis_creator
										}
										found_system = {
											move_to = this
											
											wait = {
												duration = @orbiting_delay_matriarch
												random = @orbiting_delay_matriarch_random
											}
											
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.7
													is_star = no
												}
												found_planet = {
													move_to = this
													orbit_planet = this
											
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.8
													is_planet_class = pc_gas_giant
													has_modifier = grazing_candidate
												}
												found_planet = {
													move_to = this
													orbit_planet = this
											
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
													
													effect = {
														id = mongen_matriarch_actions.effect.4
														update_gas_giant_deposit = yes
													}
												}
											}
											find_random_planet = {
												trigger = {
													id = mongen_matriarch_actions.trigger.9
													is_planet_class = pc_gas_giant
												}
												found_planet = {
													move_to = this
													orbit_planet = this
													
													wait = {
														duration = @orbiting_delay_matriarch
														random = @orbiting_delay_matriarch_random
													}
													
													effect = {
														id = mongen_matriarch_actions.effect.5
														enhancement_gas_giant_deposit = yes
													}
												}
											}
										}
									}
								}
							}
						} else_if = {
							limit = {
								exists = event_target:monster_genesis_creator
								event_target:monster_genesis_creator = {
									has_policy_flag = mongen_policy_call
								}
							}
							
							set_fleet_stance = aggressive
							
							queue_actions = {
								find_closest_system = {
									trigger = {
										id = mongen_matriarch_actions.trigger.10
										is_inside_border = event_target:monster_genesis_creator
										any_system_planet = {
											has_modifier = the_last_frontier
										}
									}
									found_system = {
										move_to = this
										
										wait = {
											duration = @orbiting_delay_matriarch
											random = @orbiting_delay_matriarch_random
										}
										
										find_random_planet = {
											trigger = {
												id = mongen_matriarch_actions.trigger.11
												has_modifier = the_last_frontier
											}
											found_planet = {
												move_to = this
												orbit_planet = this
												
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_matriarch_actions.trigger.12
												is_planet_class = pc_gas_giant
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
										find_random_planet = {
											trigger = {
												id = mongen_matriarch_actions.trigger.13
												is_star = no
											}
											found_planet = {
												move_to = this
												orbit_planet = this
										
												wait = {
													duration = @orbiting_delay_matriarch
													random = @orbiting_delay_matriarch_random
												}
											}
										}
									}
								}
							}
						}
					}
				}
				last_created_fleet = {
					if = {
						limit = {
							exists = event_target:monster_genesis_creator
							event_target:monster_genesis_creator = {
								has_policy_flag = mongen_policy_follow
							}
						}
						event_target:monster_genesis_creator = {
							random_owned_fleet = {
								limit = {
									any_owned_ship = {
										is_ship_class = shipclass_science_ship
									}
								}
								save_event_target_as = fleet_for_follow
							}
						}
						
						if = {
							limit = {
								exists = event_target:fleet_for_follow
							}
							
							set_fleet_stance = passive
							
							auto_follow_fleet = {
								target = event_target:fleet_for_follow
								attack_fleet = no
							}
						}
					}
				}
			}
		}
	}
}

# add evolution flags (deprecate evolution) to every tiyanky cow
add_monster_genesis_tiyanki_cow_evolution_flags = {
	if = {
		limit = {
			exists = event_target:monster_genesis_tiyanki_country
		}
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					has_fleet_flag = tiyanky_cow
				}
				set_fleet_flag = stop_tiyanky_cow_evolution
			}
		}
	}
}

# Remove all evolution flags from every tiyanky cow
remove_monster_genesis_tiyanki_cow_evolution_flags = {
	if = {
		limit = {
			exists = event_target:monster_genesis_tiyanki_country
		}
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					AND = {
						has_fleet_flag = tiyanky_cow
						has_fleet_flag = stop_tiyanky_cow_evolution
					}
				}
				remove_fleet_flag = stop_tiyanky_cow_evolution
			}
		}
	}
}

# Set New Evolution Flag to Tiyanki Matriarch
set_monster_genesis_matriarch_flag = {
	if = {
		limit = {
			AND = {
				exists = event_target:monster_genesis_tiyanki_country
				exists = event_target:monster_genesis_creator
			}
		}
		event_target:monster_genesis_tiyanki_country = {
			every_owned_fleet = {
				limit = {
					has_fleet_flag = tiyanky_matriarch
				}
				
				set_timed_fleet_flag = { 
					flag = tiyanky_matriarch_age
					days = @tiyanki_matriarch_age
				}
						
				event_target:monster_genesis_creator = {
					country_event = { 
						id = monster_genesis.21
						#days = 360
						#random = 360
						days = @tiyanki_matriarch_age
						random = @tiyanki_matriarch_age_random
					}
				}
			}
		}
	}
}

# Set Fleet actions after tiyanki ship replacement
set_fleet_action_after_whale_evolution = {
	if = {
		limit = {
			exists = event_target:monster_genesis_creator
		}
		event_target:monster_genesis_creator = {
			switch = {
				trigger = has_policy_flag
				
				mongen_policy_free = {
					create_order_tiyanki_free_monster_genesis = yes
				}
				
				mongen_policy_call = {
					create_order_tiyanki_call_monster_genesis = yes
				}
				
				mongen_policy_follow = {
					create_order_tiyanki_follow_monster_genesis = yes
				}
				
				default = { 
					log = "exception"
				}
			}
		}
	}
}

# Create a Tiyanki Calf Fleet Actions (needed fleet_scope)
create_monster_genesis_tiyanki_calf_actions = {
	queue_actions = {
		repeat = {
			find_random_system = {
				trigger = {
					id = mongen_tiyanki_calf_actions_free.trigger.1
					is_inside_border = event_target:monster_genesis_creator
				}
				found_system = {
				
					move_to = this
					
					wait = {
						duration = @orbiting_delay_calf
						random = @orbiting_delay_calf_random
					}
					
					find_random_planet = {
						trigger = {
							id = mongen_tiyanki_calf_actions_free.trigger.2
							is_planet_class = pc_gas_giant
							has_modifier = grazing_candidate
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_calf
								random = @orbiting_delay_calf_random
							}
							
							effect = {
								id = mongen_tiyanki_calf_actions_free.effect.1
								update_gas_giant_deposit = yes
							}
						}
					}
					find_closest_planet = {
						trigger = {
							id = mongen_tiyanki_calf_actions_free.trigger.3
							is_colony = yes
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							effect = {
								id = mongen_tiyanki_calf_actions_free.effect.2
								if = {
									limit = {
										has_modifier = sky_visiter
									}
									remove_modifier = sky_visiter
								}
								add_modifier = { 
									modifier = sky_visiter 
									#days = -1
									days = @sky_visiter_duration_days
								}
							}
							
							wait = {
								duration = @orbiting_delay_calf
								random = @orbiting_delay_calf_random
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_tiyanki_calf_actions_free.trigger.4
							is_star = no
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_calf
								random = @orbiting_delay_calf_random
							}
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Cow Fleet Actions (needed fleet_scope)
create_monster_genesis_tiyanki_cow_actions = {
	queue_actions = {
		repeat = {
			find_random_system = {
				trigger = {
					id = mongen_cow_actions_free.trigger.1
					is_inside_border = event_target:monster_genesis_creator
				}
				found_system = {
					
					move_to = this
					
					wait = {
						duration = @orbiting_delay_cow
						random = @orbiting_delay_cow_random
					}
					
					find_random_planet = {
						trigger = {
							id = mongen_cow_actions_free.trigger.2
							is_planet_class = pc_gas_giant
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_cow
								random = @orbiting_delay_cow_random
							}
							
							effect = {
								id = mongen_cow_actions_free.effect.1
								update_gas_giant_deposit = yes
							}
						}
					}
					find_closest_planet = {
						trigger = {
							id = mongen_cow_actions_free.trigger.3
							is_star = no
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_cow
								random = @orbiting_delay_cow_random
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_cow_actions_free.trigger.4
							is_planet_class = pc_gas_giant
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_cow
								random = @orbiting_delay_cow_random
							}
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Bull Fleet Actions (needed fleet_scope)
create_monster_genesis_tiyanki_bull_actions = {
	queue_actions = {
		repeat = {
			find_random_system = {
				trigger = {
					id = mongen_bull_actions_free.trigger.1
					is_inside_border = event_target:monster_genesis_creator
				}
				found_system = {
					move_to = this
					
					wait = {
						duration = @orbiting_delay_bull
						random = @orbiting_delay_bull_random
					}
					
					find_random_planet = {
						trigger = {
							id = mongen_bull_actions_free.trigger.2
							is_planet_class = pc_gas_giant
							has_modifier = grazing_candidate
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_bull
								random = @orbiting_delay_bull_random
							}
							
							effect = {
								id = mongen_bull_actions_free.effect.1
								update_gas_giant_deposit = yes
							}
						}
					}
					find_closest_planet = {
						trigger = {
							id = mongen_bull_actions_free.trigger.3
							is_planet_class = pc_gas_giant
							NOT = { has_modifier = grazing_candidate }
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_bull
								random = @orbiting_delay_bull_random
							}
							
							effect = {
								id = mongen_bull_actions_free.effect.2
								if = {
									limit = {
										has_modifier = grazing_candidate
									}
									remove_modifier = grazing_candidate
								}
								add_modifier = {
									modifier = grazing_candidate
									days = -1
								}
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_bull_actions_free.trigger.4
							is_star = no
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_bull
								random = @orbiting_delay_bull_random
							}
						}
					}
				}
			}
		}
	}
}

# Create a Tiyanki Matriarch Fleet Actions (needed fleet_scope)
create_monster_genesis_tiyanki_matriarch_actions = {
	queue_actions = {
		repeat = {
			find_random_system = {
				trigger = {
					id = mongen_matriarch_actions_free.trigger.1
					is_inside_border = event_target:monster_genesis_creator
					
					any_system_planet = {
						is_colony = yes
					}
				}
				found_system = {
					move_to = this
					
					wait = {
						duration = @orbiting_delay_matriarch
						random = @orbiting_delay_matriarch_random
					}
					
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.2
							is_colony = yes
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							effect = {
								id = mongen_matriarch_actions_free.effect.1
								if = {
									limit = {
										has_modifier = sky_visiter
									}
									remove_modifier = sky_visiter 
								}
								add_modifier = { 
									modifier = sky_visiter 
									days = @sky_visiter_duration_days
								}
							}
					
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.3
							has_anomaly = yes
						}
						found_planet = {
							move_to = this
							orbit_planet = this
					
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.4
							is_planet_class = pc_gas_giant
							has_modifier = grazing_candidate
						}
						found_planet = {
							move_to = this
							orbit_planet = this
					
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
							
							effect = {
								id = mongen_matriarch_actions_free.effect.2
								update_gas_giant_deposit = yes
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.5
							is_planet_class = pc_gas_giant
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
							
							effect = {
								id = mongen_matriarch_actions_free.effect.3
								enhancement_gas_giant_deposit = yes
							}
						}
					}
				}
			}
			find_random_system = {
				trigger = {
					id = mongen_matriarch_actions_free.trigger.6
					is_inside_border = event_target:monster_genesis_creator
				}
				found_system = {
					move_to = this
					
					wait = {
						duration = @orbiting_delay_matriarch
						random = @orbiting_delay_matriarch_random
					}
					
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.7
							is_star = no
						}
						found_planet = {
							move_to = this
							orbit_planet = this
					
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.8
							is_planet_class = pc_gas_giant
							has_modifier = grazing_candidate
						}
						found_planet = {
							move_to = this
							orbit_planet = this
					
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
							
							effect = {
								id = mongen_matriarch_actions_free.effect.4
								update_gas_giant_deposit = yes
							}
						}
					}
					find_random_planet = {
						trigger = {
							id = mongen_matriarch_actions_free.trigger.9
							is_planet_class = pc_gas_giant
						}
						found_planet = {
							move_to = this
							orbit_planet = this
							
							wait = {
								duration = @orbiting_delay_matriarch
								random = @orbiting_delay_matriarch_random
							}
							
							effect = {
								id = mongen_matriarch_actions_free.effect.5
								enhancement_gas_giant_deposit = yes
							}
						}
					}
				}
			}
		}
	}
}

# Create order CALL for Tiyanki Fleet (need fleet_scope)
create_order_tiyanki_call_monster_genesis = {

	clear_fleet_actions = this
	
	set_fleet_stance = aggressive
			
	queue_actions = {
		find_closest_system = {
			trigger = {
				id = order_tiyanki_call_monster_genesis.trigger.1
				is_inside_border = event_target:monster_genesis_creator
				any_system_planet = {
					has_modifier = the_last_frontier
				}
			}
			found_system = {
				move_to = this
				
				wait = {
					duration = @orbiting_delay_matriarch
					random = @orbiting_delay_matriarch_random
				}
				
				find_random_planet = {
					trigger = {
						id = order_tiyanki_call_monster_genesis.trigger.2
						has_modifier = the_last_frontier
					}
					found_planet = {
						move_to = this
						orbit_planet = this
						
						wait = {
							duration = @orbiting_delay_matriarch
							random = @orbiting_delay_matriarch_random
						}
					}
				}
				find_random_planet = {
					trigger = {
						id = order_tiyanki_call_monster_genesis.trigger.3
						is_planet_class = pc_gas_giant
					}
					found_planet = {
						move_to = this
						orbit_planet = this
				
						wait = {
							duration = @orbiting_delay_matriarch
							random = @orbiting_delay_matriarch_random
						}
					}
				}
				find_random_planet = {
					trigger = {
						id = order_tiyanki_call_monster_genesis.trigger.4
						is_star = no
					}
					found_planet = {
						move_to = this
						orbit_planet = this
				
						wait = {
							duration = @orbiting_delay_matriarch
							random = @orbiting_delay_matriarch_random
						}
					}
				}
			}
		}
	}
}

# Create order FOLLOW for Tiyanki Fleet (need fleet_scope)
create_order_tiyanki_follow_monster_genesis = {
	event_target:monster_genesis_creator = {
		random_owned_fleet = {
			limit = {
				any_owned_ship = {
					is_ship_class = shipclass_science_ship
				}
			}
			save_event_target_as = fleet_for_follow
		}
	}
	
	if = {
		limit = {
			exists = event_target:fleet_for_follow
		}
		
		set_fleet_stance = passive
		
		clear_fleet_actions = this
		
		auto_follow_fleet = {
			target = event_target:fleet_for_follow
			attack_fleet = no
		}
	}
}

# Create order FREE for Tiyanki Fleet (need fleet_scope)
create_order_tiyanki_free_monster_genesis = {

	clear_fleet_actions = this
	
	switch = {
		trigger = has_fleet_flag
		
		tiyanky_calf = {
			create_monster_genesis_tiyanki_calf_actions = yes
			set_fleet_stance = passive
		}
		
		tiyanky_cow = { 
			create_monster_genesis_tiyanki_cow_actions = yes
			set_fleet_stance = passive
		}
		
		tiyanky_bull = { 
			create_monster_genesis_tiyanki_bull_actions = yes
			set_fleet_stance = aggressive
		}
		
		tiyanky_matriarch = { 
			create_monster_genesis_tiyanki_matriarch_actions = yes
			set_fleet_stance = passive
		}
		
		default = { 
			log = "exception"
		} 
	}
}

# Create a Tiyanki Calf ship
create_monster_genesis_tiyanki_calf_ship = {
	create_ship = {
		name = "NAME_Calf"
		design = "NAME_MG_Tiyanki_Calf"
		prefix = no
		upgradable = no
	}
}

# Create a Tiyanki Cow ship
create_monster_genesis_tiyanki_cow_ship = {
	create_ship = {
		name = "NAME_Cow"
		design = "NAME_MG_Tiyanki_Cow"
		prefix = no
		upgradable = no
	}
}

# Create a Tiyanki Bull ship
create_monster_genesis_tiyanki_bull_ship = {
	create_ship = {
		name = "NAME_Bull"
		design = "NAME_MG_Tiyanki_Bull"
		prefix = no
		upgradable = no
	}
}

# Create a Tiyanki Matriarch ship
create_monster_genesis_tiyanki_matriarch_ship = {
	create_ship = {
		name = ""
		design = "NAME_MG_Progenitor"
		prefix = no
		upgradable = no
	}
	
	add_monster_genesis_tiyanki_cow_evolution_flags = yes
}

# Increase Power of a Tiyanki Matriarch by time (ship_scope)
increase_monster_genesis_tiyanki_matriarch_ship_power = {
	add_modifier = { modifier = "tiyanki_hull_boost"				days = -1 }
	add_modifier = { modifier = "tiyanki_armor_boost"				days = -1 }
	add_modifier = { modifier = "tiyanki_weapon_range_boost" 		days = -1 }
	add_modifier = { modifier = "tiyanki_speed_boost"				days = -1 }
	add_modifier = { modifier = "matriarch_enemy_disengage_boost" 	days = -1 }
}

# Increase Power of Random Tiyanki Bull Guardian by time (ship_scope)
increase_monster_genesis_tiyanki_bull_guardian_ship_power = {
	add_modifier = { modifier = "tiyanki_hull_boost"	days = -1 }
	add_modifier = { modifier = "tiyanki_armor_boost"	days = -1 }
	add_modifier = { modifier = "tiyanki_speed_boost"	days = -1 }
}

# Tiyanki Matriarch Born new Bull Guardian (more stronger that you can create, and stay stronger with time)
create_bull_by_matriarch_monster_genesis = {
	create_ship = {
		name = "NAME_MG_Tiyanki_Bull_Guardian"
		design = "NAME_MG_Tiyanki_Bull_Guardian"
		prefix = no
		upgradable = no
	}
	
	event_target:monster_genesis_creator = {
		country_event = { id = monster_genesis.22 }
	}
}

update_sky_visiter_modifiers = {
	if ={ 
       limit = {
		   exists = event_target:monster_genesis_creator
       }
	   event_target:monster_genesis_creator = {
			every_owned_planet = {
				limit = {
					has_modifier = sky_visiter
				}
				remove_modifier = sky_visiter
			}
	   }
	   event_target:monster_genesis_creator = {
			every_owned_planet = {
				limit = {
					AND = {
						NOT = { has_modifier = sky_visiter }
						any_fleet_in_orbit = {
							OR = {
								has_fleet_flag = tiyanky_calf
								has_fleet_flag = tiyanky_matriarch
							}
						}
					}
				}
				add_modifier = { 
					modifier = sky_visiter 
					#days = -1
					days = @sky_visiter_duration_days
				}
			}
	   }
   }
}

enhancement_gas_giant_deposit = {
	random_list = {
		75 = {
			add_deposit = d_energy_1
		}
		20 = {
			set_deposit = d_exotic_gases_1
		}
		5 = {
			reroll_deposits = yes
		}
	}
}

update_gas_giant_deposit = {
	if = {
		limit = {
			AND = {
				has_modifier = tiyanki_negative_effect
				NOT = {
					has_modifier = tiyanki_positive_effect
				}
			}
		}
		
		remove_modifier = tiyanki_negative_effect
		
		add_modifier = { 
			modifier = tiyanki_positive_effect 
			years = @tiyanki_effect_duration_years
			#days = -1
		}
	}
	else_if = {
		limit = {
			AND = {
				has_modifier = tiyanki_positive_effect
				NOT = {
					has_modifier = tiyanki_negative_effect
				}
			}
		}
		
		remove_modifier = tiyanki_positive_effect
		
		add_modifier = { 
			modifier = tiyanki_negative_effect
			years = @tiyanki_effect_duration_years			
			#days = -1
		}
	}
	else = {
		random_list = {
			50 = {
				add_modifier = { 
					modifier = tiyanki_positive_effect 
					years = @tiyanki_effect_duration_years
					#days = -1
				}
			}
			50 = {
				add_modifier = { 
					modifier = tiyanki_negative_effect 
					years = @tiyanki_effect_duration_years
					#days = -1
				}
			}
		}
	}
}